"use strict";const e=require("../../common/vendor.js"),o=require("../../stores/counter.js");if(require("../../request/index.js"),!Array){(e.resolveComponent("van-notice-bar")+e.resolveComponent("van-grid-item")+e.resolveComponent("van-grid")+e.resolveComponent("van-button")+e.resolveComponent("van-dropdown-item")+e.resolveComponent("van-dropdown-menu")+e.resolveComponent("van-card")+e.resolveComponent("van-loading"))()}const t={__name:"index",setup(t){const s=o.Store(),r=e.ref([{business:"代取快递",type:"icon-rentou"},{business:"代拿外卖",type:"icon-tubiaozhizuomoban2-01"},{business:"代写笔记",type:"icon-biji"},{business:"超市代购",type:"icon-fuwuchaoshi"},{business:"校园跑腿",type:"icon-pao"},{business:"校园代跑",type:"icon-tiyu-qipao"},{business:"帮搬东西",type:"icon-iconfont_loadingbay"},{business:"代替上课",type:"icon-tongxueshangke-"},{business:"代替查寝",type:"icon-Dorm"},{business:"替试/补考",type:"icon-a-kaoshi1"}]),i=e.ref(!0),a=e.ref(!0),n=e.computed((()=>s.LBList)),c=e.ref(0),d=[{text:"默认排序",value:0},{text:"好评排序",value:1},{text:"销量排序",value:2}];e.ref(null);const l=()=>{e.wx$1.createSelectorQuery().select("#anchor").boundingClientRect((o=>{console.log(o),e.wx$1.pageScrollTo({scrollTop:o.top,duration:300})})).exec()},u=e.computed((()=>s.schoolStoreList)),p=["营业中","打样","暂停"];e.onMounted((async()=>{await s.getLBData({url:"bannerImage/list/page",method:"POST",data:{createTime:"",current:0,id:0,imageName:"",imageUrl:"",isDelete:0,pageSize:5,schoolId:1,sortField:"",sortOrder:"",state:0,user_id:0}}),await s.getSchoolStoreData({address:"",category1Id:0,current:g,delivery_price:0,delivery_time:0,id:0,isDelete:0,pageSize:5,score:0,sortField:"",sortOrder:"",start_price:0,state:0,storeName:""}),console.log(s.schoolStoreList)})),e.onLoad((async()=>{e.index.getProvider({service:"oauth",success:function(o){o.provider.includes("weixin")&&e.index.login({provider:"weixin",success:o=>{o.code?e.index.request({url:"http://localhost:8121/api/user/login/wx_open",data:{code:o.code},method:"GET",success:o=>{const t=o.header["Set-Cookie"];e.index.setStorageSync("sessionCookie",t),s.userInfo=o.data.data,s.userId=o.data.data.id},fail(){console.log("登录请求发送失败")}}):console.log("登录失败",o.errMsg)},fail(){console.log("授权失败")}})}})}));let m=e.ref(!1),g=1;e.onReachBottom((async()=>{m.value=!0,await setTimeout((()=>{m.value=!1,g++,s.getSchoolStoreData({address:"",category1Id:0,current:g,delivery_price:0,delivery_time:0,id:0,isDelete:0,pageSize:5,score:0,sortField:"",sortOrder:"",start_price:0,state:0,storeName:""})}),1e3)}));const v=()=>{e.index.redirectTo({url:"/subpages/takeaway/takeaway"})};return(o,t)=>({a:e.f(e.unref(n),((e,o,t)=>({a:e.imageUrl,b:e.id}))),b:i.value,c:a.value,d:3e3,e:500,f:e.p({leftIcon:"volume-o",text:"在代码阅读过程中人们说脏话的频率是衡量代码质量的唯一标准。"}),g:e.o(l),h:e.p({useSlot:!0,text:"校园外卖"}),i:e.f(r.value,((o,t,s)=>({a:e.n(`${o.type}`),b:e.t(o.business),c:e.o((o=>(o=>{o++,e.index.navigateTo({url:`/subpages/publish/publish?index=${o}`})})(t)),t),d:t,e:"e04f1547-3-"+s+",e04f1547-1",f:e.p({useSlot:!0,text:o.business})}))),j:e.p({useSlot:!0,text:"代扫卫生"}),k:e.p({square:!0,iconSize:"20px"}),l:e.p({round:!0,size:"normal",type:"primary"}),m:e.o(v),n:e.p({round:!0,type:"primary"}),o:e.p({value:c.value,options:d}),p:e.f(e.unref(u),((o,t,s)=>({a:e.t(p[o.state]),b:e.t(o.score),c:e.t(o.start_price),d:e.t(o.delivery_price),e:e.t(o.delivery_time),f:"e04f1547-9-"+s,g:e.p({desc:o.address,title:o.storeName,thumb:o.imageUrl}),h:t,i:e.o((t=>(o=>{let t={category1Id:o.category1Id,imageUrl:o.imageUrl,score:o.score,storeName:o.storeName,delivery_time:o.delivery_time,id:o.id,address:o.address},s=encodeURIComponent(JSON.stringify(t));e.index.navigateTo({url:`/subpages/detail/detail?params=${s}`,animationType:"pop-in",animationDuration:200})})(o)),t)}))),q:e.p({color:"#1989fa",type:"spinner"}),r:e.unref(m)})}},s=e._export_sfc(t,[["__scopeId","data-v-e04f1547"]]);wx.createPage(s);
